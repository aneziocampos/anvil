module Anvil
  class Vulnerability
    attr_reader :client, :args

    def initialize(client)
      raise ArgumentError, 'client param must be a Client class' if client.class != Anvil::Client

      @client = client
    end

    def create!(*params)
      conn = Faraday.new(url: @client.base_url)
      conn.post '/api/v2/vulnerabilities', vulnerability: params.first,
                                           api_key: @client.api_key
    end
  end
end
