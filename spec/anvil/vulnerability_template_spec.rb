require 'anvil/client'
require 'anvil/vulnerability_template'

describe Anvil::VulnerabilityTemplate do
  let(:client) { Anvil::Client.new('foobar', 'staging') }
  describe '.initialize' do
    context 'with proper params' do
      it do
        expect(Anvil::VulnerabilityTemplate.new(client))
          .to be_an_instance_of Anvil::VulnerabilityTemplate
      end
    end

    context 'with invalid params' do
      it do
        expect { Anvil::VulnerabilityTemplate.new('foobar') }
          .to raise_error ArgumentError
      end
    end
  end

  describe 'search' do
    it "http" do
      allow(Anvil::VulnerabilityTemplate.new(client).search('foo')).to receive(:body).and_return('the actual body of response')
    end
    # it do
    #   expect(Anvil::VulnerabilityTemplate.new(client).search('foo'))
    #     .to eq 'creating vulnerability '
    # end
  end
end
